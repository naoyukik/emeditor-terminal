description = "GitHubのプルリクエストレビューコメントを確認し、必要な修正や改善を行うためにタスク管理を行います。"

# language=markdown
prompt = """
# steps
- name: Review PR Comments
  description: GitHub Copilot のプルリクエストレビューコメントを確認し、必要な修正や改善を特定します。
- name: Document Changes
  description: 変更内容をドキュメント化し、将来の参考のために記録します。

# レビューコメントの取得方法
GitHub MCP Serverの `pull_request_read` ツールでレビューコメントを取得する。

pull_request_readで取得できない場合、下記のコマンドを使用してください。
`PULL_NUMBER` はユーザーに提示しもらうか、もしくは既存の情報から取得してください。
```bash
# GitHub CLI api
# https://cli.github.com/manual/gh_api

gh api \
  -H "Accept: application/vnd.github+json" \
  -H "X-GitHub-Api-Version: 2022-11-28" \
  /repos/OWNER/REPO/pulls/PULL_NUMBER/comments
```
このAPIはデフォルトでは、レビューコメントはIDの昇順で並べ替えられます。

# レビューコメントの報告
レビューコメントを取得したら、ユーザーに以下のフォーマットで報告してください。
> **【PR Review Comments】**
> - **Total Comments**: `X` 件のレビューコメントが見つかりました
> - **Comments Summary**:
> - 1. `コメント内容1` - 指摘内容の概要
> - 2. `コメント内容2` - 指摘内容の概要

# 妥当性やスコープの吟味
レビューコメントの内容を吟味し、実装すべき修正点や改善点を特定してください。必要に応じて、ユーザーに確認を取ることも検討してください。
また、指摘を「今回のPRの変更が影響を及ぼし、今回のPRで必須なもの」と「将来的な改善（別タスク）に回すべきもの」に明確に切り分けます。切り分けは後続の `分類と対応方針` を参照。
吟味した結果、トータル的に実装する必要がないと判断すれば、その旨をユーザーに報告してください。

## 分類と対応方針
レビューコメントを以下のカテゴリに分類し、対応方針を決定せよ。
1.  Critical / Safety: セキュリティ、クラッシュ、安全性、コンパイル警告に関わるもの。
       -> Action*: 今回のPRで必ず修正する。
2.  Bug Fix: PRの機能が正しく動作しない原因となるもの。
       -> Action*: 今回のPRで修正する。
3.  Refactoring / Design: 設計の美しさ、カプセル化、将来の拡張性に関するもの。
       -> Action*: 今回は修正せず、"Future Ticket" として起票する。
4.  Optimization: パフォーマンス改善（現状でボトルネックでない場合）。
       -> Action*: 今回は修正せず、"Future Ticket" として起票する。
5.  Nitpick: 些細な指摘（スコープ外のエッジケースなど）。
       -> Action*: 無視、または丁重に断る。

# タスク管理

タスクを忘れずに実行できるように、Conductorの現在進行中のtrackにタスクを追加してください

# 終了
タスク管理まで完了したら、実装は行わずにこのスキルを終了してください
"""
