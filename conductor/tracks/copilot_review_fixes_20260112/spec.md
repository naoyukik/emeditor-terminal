# 仕様書: GitHub Copilot 指摘への対応とコード品質の向上

## 概要
PR #2 に対して GitHub Copilot から提案された修正事項（コードの堅牢性、ドキュメントの整合性、ビルドプロセスの改善）をすべて適用し、プロジェクトの品質を向上させる。

## 変更要件

### 1. インストールスクリプト (`install.ps1`) の改善
- **柔軟性**: インストール先ディレクトリを `-Dest` 引数で指定可能にする。未指定の場合はデフォルトパスを使用する。
- **堅牢性**: `cargo build` 実行直後に終了コード (`$LASTEXITCODE`) を確認し、失敗した場合は即座にエラー終了する。

### 2. ビルド設定 (`build.rs`) の改善
- **堅牢性**: リンカに渡す `exports.def` のパスを、環境変数 `CARGO_MANIFEST_DIR` を使用した絶対パスに変更する。

### 3. ソースコード (`src/lib.rs`) の品質向上
- **安全性**: `QueryStatus` 関数において、`pbChecked` ポインタが `null` でないことを確認してから値を代入するチェックを追加する。
- **可読性**: 現在未使用の定数 `EVENT_CLOSE` に対し、将来的にプラグインの終了処理で使用予定である旨のコメントを追加する。

### 4. ドキュメントの修正
- **整合性**: `docs/INSTALL.md` 内の手動インストール手順に記載されているパスを、`install.ps1` で使用している `$env:LOCALAPPDATA\Programs\EmEditor\PlugIns` と一致させる。
- **タイポ修正**: `conductor/product-guidelines.md` に含まれる韓国語の助詞「의」を、日本語の「の」に修正する。

## 受入基準
- `install.ps1` が引数なしで従来通り動作し、かつ不適切なパス環境でも `-Dest` 指定で動作すること。
- `cargo build` が成功すること。
- 修正後のプラグインが EmEditor で正常に認識され、Hello World コマンドが実行できること。
- ドキュメント内の不整合やタイポが解消されていること。
