# 実装計画: 起動時の入力ダイアログを廃止し直接ターミナルを起動する

## Phase 1: クリーンアップと準備
このフェーズでは、不要になるダイアログ関連コードの削除と、リファクタリングの準備を行う。

- [ ] Task: `src/dialog.rs` の削除
    - [ ] `src/dialog.rs` ファイルを削除する。
    - [ ] `src/lib.rs` から `mod dialog;` を削除する。
- [ ] Task: 依存関係の整理
    - [ ] `src/lib.rs` で使用されなくなる `windows::Win32::UI::WindowsAndMessaging` 関連の不要なインポートを整理する。

## Phase 2: 起動ロジックの修正
ダイアログ入力に依存していた起動ロジックを、固定コマンドによる即時起動に変更する。

- [ ] Task: `OnCommand` 関数の修正
    - [ ] `src/lib.rs` の `OnCommand` 関数内で、`dialog::show_input_dialog` の呼び出しを削除する。
    - [ ] 代わりに、固定値 `"pwsh.exe"` を使用して `custom_bar::send_input` (または同等の初期化処理) を呼び出すように変更する。
- [ ] Task: コンパイルと動作確認
    - [ ] `cargo build` が成功することを確認する。

## Phase 3: 検証
変更が正しく機能しているかを確認する。

- [ ] Task: 手動テスト
    - [ ] 生成されたDLLをEmEditorにロードし、プラグインボタンを押下する。
    - [ ] ダイアログが表示されず、即座に `pwsh.exe` が起動することを確認する。
    - [ ] 複数回ボタンを押した場合の挙動（新しいタブ/ウィンドウが開くか）を確認する。
